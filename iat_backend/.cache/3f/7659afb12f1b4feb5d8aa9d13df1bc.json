{"id":"node_modules/data.js/lib/parser/xlsx.js","dependencies":[{"name":"/home/tiago/works/iat_backend/package.json","includedInParent":true,"mtime":1582375201195},{"name":"/home/tiago/works/iat_backend/node_modules/data.js/package.json","includedInParent":true,"mtime":1577388714717},{"name":"stream","loc":{"line":3,"column":25},"parent":"/home/tiago/works/iat_backend/node_modules/data.js/lib/parser/xlsx.js","resolved":"/home/tiago/works/iat_backend/node_modules/stream-browserify/index.js"},{"name":"xlsx","loc":{"line":5,"column":21},"parent":"/home/tiago/works/iat_backend/node_modules/data.js/lib/parser/xlsx.js","resolved":"/home/tiago/works/iat_backend/node_modules/xlsx/xlsx.js"},{"name":"csv-parse","loc":{"line":7,"column":22},"parent":"/home/tiago/works/iat_backend/node_modules/data.js/lib/parser/xlsx.js","resolved":"/home/tiago/works/iat_backend/node_modules/csv-parse/lib/index.js"},{"name":"./csv","loc":{"line":11,"column":12},"parent":"/home/tiago/works/iat_backend/node_modules/data.js/lib/parser/xlsx.js","resolved":"/home/tiago/works/iat_backend/node_modules/data.js/lib/parser/csv.js"}],"generated":{"js":"\"use strict\";\n\nconst Readable = require('stream').Readable;\n\nconst XLSX = require('xlsx');\n\nconst parse = require('csv-parse');\n\nconst {\n  getParseOptions\n} = require('./csv');\n\nconst xlsxParser = async function xlsxParser(file) {\n  let keyed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let sheetIdxOrName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  let buffer;\n\n  if (typeof window === 'undefined') {\n    // Not in browser so 'buffer' is available\n    buffer = await file.buffer;\n  } else {\n    // Running in browser\n    buffer = await file.browserBuffer;\n  }\n\n  const workbook = XLSX.read(buffer, {\n    type: 'buffer'\n  });\n  let selectedSheetName = sheetIdxOrName;\n\n  if (sheetIdxOrName.constructor.name === 'Number') {\n    selectedSheetName = workbook.SheetNames[sheetIdxOrName];\n  }\n\n  const sheet = workbook.Sheets[selectedSheetName];\n  const csv = XLSX.utils.sheet_to_csv(sheet);\n  const stream = new Readable();\n  stream.push(csv);\n  stream.push(null);\n  return stream.pipe(parse({\n    columns: keyed ? true : null,\n    ltrim: true\n  }));\n};\n\nmodule.exports = {\n  xlsxParser\n};"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":2,"column":0},"generated":{"line":2,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":3,"column":0},"generated":{"line":3,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":4,"column":0},"generated":{"line":4,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":5,"column":0},"generated":{"line":5,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":6,"column":0},"generated":{"line":6,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":7,"column":0},"generated":{"line":7,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":8,"column":0},"generated":{"line":8,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":9,"column":0},"generated":{"line":9,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":10,"column":0},"generated":{"line":10,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":11,"column":0},"generated":{"line":11,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":12,"column":0},"generated":{"line":12,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":13,"column":0},"generated":{"line":13,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":14,"column":0},"generated":{"line":14,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":15,"column":0},"generated":{"line":15,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":16,"column":0},"generated":{"line":16,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":17,"column":0},"generated":{"line":17,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":18,"column":0},"generated":{"line":18,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":19,"column":0},"generated":{"line":19,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":20,"column":0},"generated":{"line":20,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":21,"column":0},"generated":{"line":21,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":22,"column":0},"generated":{"line":22,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":23,"column":0},"generated":{"line":23,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":24,"column":0},"generated":{"line":24,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":25,"column":0},"generated":{"line":25,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":26,"column":0},"generated":{"line":26,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":27,"column":0},"generated":{"line":27,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":28,"column":0},"generated":{"line":28,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":29,"column":0},"generated":{"line":29,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":30,"column":0},"generated":{"line":30,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":31,"column":0},"generated":{"line":31,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":32,"column":0},"generated":{"line":32,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":33,"column":0},"generated":{"line":33,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":34,"column":0},"generated":{"line":34,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":35,"column":0},"generated":{"line":35,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":36,"column":0},"generated":{"line":36,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":37,"column":0},"generated":{"line":37,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":38,"column":0},"generated":{"line":38,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":39,"column":0},"generated":{"line":39,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":40,"column":0},"generated":{"line":40,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":41,"column":0},"generated":{"line":41,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":42,"column":0},"generated":{"line":42,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":43,"column":0},"generated":{"line":43,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":44,"column":0},"generated":{"line":44,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":45,"column":0},"generated":{"line":45,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":46,"column":0},"generated":{"line":46,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":47,"column":0},"generated":{"line":47,"column":0}},{"source":"node_modules/data.js/lib/parser/xlsx.js","original":{"line":48,"column":0},"generated":{"line":48,"column":0}}],"sources":{"node_modules/data.js/lib/parser/xlsx.js":"\"use strict\";\n\nconst Readable = require('stream').Readable;\n\nconst XLSX = require('xlsx');\n\nconst parse = require('csv-parse');\n\nconst {\n  getParseOptions\n} = require('./csv');\n\nconst xlsxParser = async function xlsxParser(file) {\n  let keyed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let sheetIdxOrName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  let buffer;\n\n  if (typeof window === 'undefined') {\n    // Not in browser so 'buffer' is available\n    buffer = await file.buffer;\n  } else {\n    // Running in browser\n    buffer = await file.browserBuffer;\n  }\n\n  const workbook = XLSX.read(buffer, {\n    type: 'buffer'\n  });\n  let selectedSheetName = sheetIdxOrName;\n\n  if (sheetIdxOrName.constructor.name === 'Number') {\n    selectedSheetName = workbook.SheetNames[sheetIdxOrName];\n  }\n\n  const sheet = workbook.Sheets[selectedSheetName];\n  const csv = XLSX.utils.sheet_to_csv(sheet);\n  const stream = new Readable();\n  stream.push(csv);\n  stream.push(null);\n  return stream.pipe(parse({\n    columns: keyed ? true : null,\n    ltrim: true\n  }));\n};\n\nmodule.exports = {\n  xlsxParser\n};"},"lineCount":48}},"error":null,"hash":"84848587d1f5f8121622c873d370d7f7","cacheData":{"env":{}}}